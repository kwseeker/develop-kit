# 事件发布订阅

使用场景太广泛了，任何需要根据条件或事件更新的地方都可以用到。实际业务场景中感觉很多地方可以用到，但是没总结过，写业务时也没分配开发个好用的组件的时间，写了好多“敏捷的丑陋的不可复用”的代码，感觉不爽，还是老老实实的抽点时间总结下，抽离几个可以拿来即用的事件发布订阅组件。

**场景**：

+ 保证数据一致性

  比如：

  + 数据一致性协议实现

+ 动态开关/动态配置

  比如：

  + 活动期间和非活动期间配置切换，切换之后告知各个服务实例
  + Debug日志开关，开关之后告知各个服务实例

+ 软件解耦

**实现方式**：

+ 观察者模式/回调

+ 网络通信/事件处理协议

**具体方案**：

+ 按照观察者模式 / 回调自行设计
  + 参考Spring事件机制
+ 借助网络通信自行设计协议
  + 参考配置中心等中间件

+ 阻塞队列容器类（本地场景) / 消息队列中间件（分布式场景）

+ Redis发布订阅模式
+ Guava EventBus

> 要点：
>
> 1）事件发布（手动发布、自动检测条件）
>
> 2）事件传输（队列[属于共享存储]、网络通信）
>
> 3）事件处理



## Redis发布订阅

Jedis、Redission 都有提供接口。

 